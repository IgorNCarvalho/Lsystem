<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <h2>Informações da linguagem</h2>
    Σ   - Alfabeto da linguagem<br>
    n   - Passos, etapas<br>
    ω   - Axioma, condição inicial<br>
    δ   - Angulo<br>
    pX  - Regras de produção<br><br>


    Por favor selecione arquivo que será lido:
    <input type="file" id="txtfiletoread" /><br />
    <div>Conteúdo do arquivo:</div>
    <div id="filecontents">
    </div>

   <!-- Criar linha 
       
    <svg height="210" width="500">
        <line x1="0" y1="0" x2="200" y2="200" style="stroke:rgb(255,0,0);stroke-width:2" />
      </svg>
    -->

    <script>

        window.onload = function () {
            //Check the support for the File API support
            if (window.File && window.FileReader && window.FileList && window.Blob) {
                var fileSelected = document.getElementById('txtfiletoread');
                fileSelected.addEventListener('change', function (e) {
                    //Set the extension for the file
                    var fileExtension = /text.*/;
                    //Get the file object
                    var fileTobeRead = fileSelected.files[0];
                    //Check of the extension match
                    if (fileTobeRead.type.match(fileExtension)) {
                        //Initialize the FileReader object to read the 2file
                        var fileReader = new FileReader();
                        fileReader.onload = function (e) {
                            var fileContents = document.getElementById('filecontents');
                            fileContents.innerText = fileReader.result;
                        }
                        fileReader.readAsText(fileTobeRead);
                    }
                    else {
                        alert("Por favor selecione arquivo texto");
                    }

                }, false);
            }
            else {
                alert("Arquivo(s) não suportado(s)");
            }
        }



        

       /* var line_container = $LineContainer
        var lines = []

        function _ready(){
            yield(get_tree(), "idle_frame")
	        yield(get_tree(), "idle_frame")
	        var center = Vector2(get_viewport_rect().end.x / 2, get_viewport_rect().end.y / 2)
	        var bottom_center = Vector2(get_viewport_rect().end.x / 2, get_viewport_rect().end.y)
	        var bottom_right = Vector2(get_viewport_rect().end.x / 3 * 2, get_viewport_rect().end.y)
	
	        lines = generate(bottom_center, 5, 0.6, Color(0.9, 0.6, 1.0, 0.7), 2.0, FractalTree.new())

        }
	
        function _process(delta){
            if (lines.empty())
		        return
	    var lines_per_frame = 100000

        array.forEach(index => lines_per_frame) 
        {
            line_container.add_child(lines.pop_front())	
		    if (lines.empty()){
                break
            }    
        }
			

    function generate(start_position, iterations, length_reduction, color, width, rule){
        var length = -200
	    var arrangement = rule.Aaxiom
	    array.forEach(i in iterations)
		{ 
            length *= length_reduction
		    var new_arrangement = ""
		    array.forEach(character in arrangement)
			    new_arrangement += rule.get_character(character)
		    arrangement = new_arrangement
        }
	
	var lines = []
	var from = start_position
	var rot = 0
	var cache_queue = []
	array.forEach(index in arrangement)
    {
        match .get_action(index)
        {
            "draw_forward"
            {
                var to = from + Vector2(0, length).rotated(deg2rad(rot))
				var line = Line2D.new()
				line.default_color = color
				line.width = width
				line.antialiased = true
				line.add_point(from)
				line.add_point(to)
				lines.push_back(line)
				from = to
            }
			"rotate_right"
            {
                rot += rule.angle
            }
				
			"rotate_left"
            {
                rot -= rule.angle
            }
				
			"store"
            {
                cache_queue.push_back([from, rot])
            }
				
			"load"
            {
                var cached_data = cache_queue.pop_back()
				from = cached_data[0]
				rot = cached_data[1]
            }	
        }	
    }
    return lines;

	
   function Rule ()
    {
        var Aaxiom
	    var rules = {}
	    var actions = {}
	    var angle
	
	    function get_character(character){
            if(rules.has(character))
			    return rules.get(character)
		return character
    }
		
	
	function get_action(character){
		return actions.get(character)
    }
	

class FractalTree extends Rule 
    {
        _init()
        {
            self.Aaxiom = "F"
		    self.angle = 25
		    self.rules = {
			    "F" : "FF+[+F-F-F]-[-F+F+F]",
		    }  
        }

		actions = {
			"F" : "draw_forward",
			"+" : "rotate_right",
			"-" : "rotate_left",
			"[" : "store",
			"]" : "load"
        }
	}
}
    }
}*/
    </script>
</body>
</html>